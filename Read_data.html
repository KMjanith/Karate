<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>backend</title>
    <script src="https://cdn.rawgit.com/Keyang/node-csvtojson/d41f44aa/browser/csvtojson.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5" id="main">
        <h2 id="h2"></h2>
        <label>age</label>
        <input type="text" id="age">
        <button id="submit" onclick="selector()">submit</button>
    <br>
        <table class="table table-striped">
            <thead>
                <th>full_name</th>
                <th>email</th>
                <th>Age</th>
                <th>message</th>
            </thead>
            <tbody id="tbody">
            </tbody>
        </table>

        
    </div>

    <script>
        

        function selector(){

            const url = "https://docs.google.com/spreadsheets/d/1EjrH6dp5beGc1Xay__xsHPCAky45Gnvxt9i8n0yOaA8/export?format=csv"
            let main = document.getElementById("main");
            var h2 = document.getElementById("h2");
            h2.innerHTML = '';
            var table_body = document.getElementById("tbody");
            table_body.innerHTML = '';
            let age = document.getElementById("age").value;

            fetch(url).then(result => result.text()).then(function (csvtext) {
                return csv().fromString(csvtext);
            }).then(function (csv) {
                //main.innerHTML = "<code>" + JSON.stringify(csv) + "</code>";
                let number = 0;
                csv.forEach(function (row) {
                    if (row.age === age) {
                        number = number + 1;
                        table_body.innerHTML += "<tr>" + "<td> " + row.full_name + "</td >" + "<td>" + row.email + "</td>" +
                            "<td>" + row.age + "</td>" + "<td>" + row.message + "</td>" + "</tr>"
                    }
                    


                })
                h2.innerHTML = "number of elements: " + number;
                document.getElementById("age").value = "";
            })
        }
        

    </script>
</body>
    
</html>